table inet basic {
  chain input {
    type filter hook input priority filter; policy accept;
    iifname "lo" accept
    ct state established,related accept
    ct state invalid drop
    tcp flags syn / fin,  syn,rst,ack jump syn_flood
		icmp type echo-request accept
		meta nfproto ipv4 meta l4proto igmp accept
		meta l4proto ipv6-icmp ip6 saddr fe80::/10 accept
		icmpv6 type { destination-unreachable, time-exceeded, echo-request, echo-reply, nd-router-solicit, nd-router-advert } limit rate 1000/second accept
		icmpv6 type . icmpv6 code { packet-too-big . no-route, parameter-problem . no-route, nd-neighbor-solicit . no-route, nd-neighbor-advert . no-route, parameter-problem . admin-prohibited } limit rate 1000/second accept
    include "/etc/nftables/basic-input-chain/*.conf"
		jump handle_reject
  }
  chain forward {
   	type filter hook forward priority filter; policy drop;
		ct state established,related accept
    include "/etc/nftables/basic-forward-chain/*.conf"
		jump handle_reject
  }
  chain output {
		type filter hook output priority filter; policy accept;
		# oifname "lo" accept
		# ct state established,related accept
  }
	chain prerouting {
		type filter hook prerouting priority filter; policy accept;
	}

  chain syn_flood {
    limit rate 25/second burst 50 packets return
    drop
	}
	chain handle_reject {
		meta l4proto tcp reject with tcp reset
		reject
	}
  include "/etc/nftables/basic/*.conf"
}
