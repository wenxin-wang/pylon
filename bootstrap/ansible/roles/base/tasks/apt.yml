---
- name: do not download translations
  become: true
  copy:
    content: 'Acquire::Languages "none";'
    dest: /etc/apt/apt.conf.d/99translations

- name: Set apt source
  become: true
  when: debian_release is defined and debian_mirror is defined
  ansible.builtin.template:
    src: apt-source.list.j2
    dest: /etc/apt/sources.list

- name: Update apt cache if the last one is more than 1 day ago
  become: true
  ansible.builtin.apt:
    update_cache: true
    cache_valid_time: 86400

- name: Enable auto update
  when: debian_auto_update|default(false)
  become: true
  ansible.builtin.package:
    name:
      - unattended-upgrades
      - apt-listchanges
    state: present
